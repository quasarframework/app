#!/usr/bin/env node

const pe = require('pretty-error').start()
pe.skipPackage('regenerator-runtime')
pe.skipPackage('babel-runtime')
pe.skipNodeFiles()

// Console error unhandled promises
process.on('unhandledRejection', err => {
  console.error(pe.render(err))
})

const commands = [
  'dev',
  'build',
  'mode',
  'version',
  'help'
]

let cmd = process.argv[2]

if (cmd) {
  if (commands.includes(cmd)) {
    process.argv.splice(2, 1)
  }
  else {
    if (cmd.indexOf('-') === 0) {
      require('../lib/helpers/logger')('app', 'red')(`You must provide one command from [${ commands.join('|') }]`)
      cmd = 'help'
    }
    else {
      require('../lib/helpers/logger')('app', 'red')(`Unknown command "${ cmd }"`)
      process.exit(1)
    }
  }
}
else {
  cmd = 'help'
}

require(`./qapp-${cmd}`)
